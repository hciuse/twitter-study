---
title: "Data Preprocessing"
author: "LST"
date: "2024-02-28"
output: html_document
---

```{r setup, include=FALSE}
library(renv)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(esquisse)
```

## R Markdown

# Keep rows with highest last_page (people that at least started the survey)

```{r}
data <- read.csv("data/twitter_data.csv") %>% group_by(user_id) %>% filter(last_page != -1, last_page == max(last_page)) %>% ungroup()

# save all rows of reasons_change_conts_op that contain text into comments
comments_reasons_change_conts_op <- data %>% filter(!(reasons_change_conts_op %in% "")) %>% select(user_id, reasons_change_conts_op)

# save all rows of expl_new_intense_conts that contain text into comments
comments_expl_new_intense_conts <- data %>% filter(!(expl_new_intense_conts %in% "")) %>% select(user_id, expl_new_intense_conts)
```

Data filtering:

```{r}
# Filter out unnecessary columns

filtered_data_time <- data %>% select(-c(user_id, submit_date, last_page, start_language, start_date, datestamp, is_adult, ref, origin))

#filter out timing information

filtered_data <- filtered_data_time %>% select(!ends_with("time"))

# calculate age

filtered_data <- filtered_data %>% mutate(age = 2023 - year_of_birth)

# save filtered datasets

saveRDS(filtered_data, "data/filtered_data.rds")
saveRDS(filtered_data_time, "data/filtered_data_time.rds")
```

```{r}

```
